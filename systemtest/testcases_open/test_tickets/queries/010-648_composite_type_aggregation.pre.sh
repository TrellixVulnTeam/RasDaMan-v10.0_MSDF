#!/bin/bash
#
# This file is part of rasdaman community.
#
# Rasdaman community is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# Rasdaman community is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with rasdaman community.  If not, see <http://www.gnu.org/licenses/>.
#
# Copyright 2003, 2004, 2005, 2006, 2007, 2008, 2009 Peter Baumann /
# rasdaman GmbH.
#
# For more information please see <http://www.rasdaman.org>
# or contact Peter Baumann via <baumann@rasdaman.com>.

SOURCE="${BASH_SOURCE[0]}"
while [ -h "$SOURCE" ] ; do SOURCE="$(readlink "$SOURCE")"; done
UTIL_SCRIPT_DIR="$( cd -P "$( dirname "$SOURCE" )" && pwd )"

. "$UTIL_SCRIPT_DIR"/../../../util/common.sh

TYPES=/tmp/types.dl
c=test_aggregate

echo "struct FloatPixel { float band1, band2, band3, band4, band5, band6, band7, band8, band9, band10, band11, band12, band13, band14, band15, band16, band17, band18, band19, band20, band21, band22, band23, band24, band25, band26, band27, band28, band29, band30, band31, band32, band33, band34, band35, band36, band37, band38, band39, band40, band41, band42, band43, band44, band45, band46, band47, band48, band49, band50, band51, band52, band53, band54, band55, band56, band57, band58, band59, band60, band61, band62, band63, band64, band65, band66, band67, band68, band69, band70, band71, band72, band73, band74, band75, band76, band77, band78, band79, band80, band81, band82, band83, band84, band85, band86, band87, band88, band89, band90, band91, band92, band93, band94, band95, band96, band97, band98, band99, band100, band101, band102, band103, band104, band105, band106, band107, band108, band109, band110, band111, band112, band113, band114, band115, band116, band117, band118, band119, band120, band121, band122, band123, band124, band125, band126, band127, band128, band129, band130, band131, band132, band133, band134, band135, band136, band137, band138, band139, band140, band141, band142, band143, band144, band145, band146, band147, band148, band149, band150, band151, band152, band153, band154, band155, band156, band157, band158, band159, band160, band161, band162, band163, band164, band165, band166, band167, band168, band169, band170, band171, band172, band173, band174, band175, band176, band177, band178, band179, band180, band181, band182, band183, band184, band185, band186, band187, band188, band189, band190, band191, band192, band193, band194, band195, band196, band197, band198, band199, band200, band201, band202, band203, band204, band205, band206, band207, band208, band209, band210, band211, band212, band213, band214, band215, band216, band217, band218, band219, band220, band221, band222, band223, band224, band225, band226, band227, band228, band229, band230, band231, band232, band233, band234, band235, band236, band237, band238, band239, band240, band241, band242, band243, band244, band245, band246, band247, band248, band249, band250, band251, band252, band253, band254, band255, band256, band257, band258, band259, band260, band261, band262, band263, band264, band265, band266, band267, band268, band269, band270, band271, band272, band273, band274, band275, band276, band277, band278, band279, band280, band281, band282, band283, band284, band285, band286, band287, band288, band289, band290, band291, band292, band293, band294, band295, band296, band297, band298, band299, band300, band301, band302, band303, band304, band305, band306, band307, band308, band309, band310, band311, band312, band313, band314, band315, band316, band317, band318, band319, band320, band321, band322, band323, band324, band325, band326, band327, band328, band329, band330, band331, band332, band333, band334, band335, band336, band337, band338, band339, band340, band341, band342, band343, band344, band345, band346, band347, band348, band349, band350, band351, band352, band353, band354, band355, band356, band357, band358, band359, band360, band361, band362, band363, band364, band365, band366, band367, band368, band369, band370, band371, band372, band373, band374, band375, band376, band377, band378, band379, band380, band381, band382, band383, band384, band385, band386, band387, band388, band389, band390, band391, band392, band393, band394, band395, band396, band397, band398, band399, band400, band401, band402, band403, band404, band405, band406, band407, band408, band409, band410, band411, band412, band413, band414, band415, band416, band417, band418, band419, band420, band421, band422, band423, band424, band425, band426, band427, band428, band429, band430, band431, band432, band433, band434, band435, band436, band437, band438; };" > $TYPES
echo "typedef marray <FloatPixel, 2> FloatArray;" >> $TYPES
echo "typedef set <FloatArray> MyFloatSet;" >> $TYPES

rasdl -r $TYPES -i

rm -f $TYPES

echo

$RASQL -q "create collection $c MyFloatSet" > /dev/null
$RASQL -q "insert into $c values marray i in [0:3,0:3] values i + {4175.0, 18632.0, 27603.0, 4564.0, 32005.0, 26351.0, 30196.0, 32153.0, 29820.0, 4088.0, 32538.0, 13941.0, 21153.0, 31527.0, 25406.0, 32327.0, 5589.0, 24652.0, 8295.0, 1476.0, 8682.0, 12390.0, 10738.0, 31749.0, 19948.0, 22931.0, 26121.0, 23269.0, 4388.0, 24769.0, 20367.0, 21100.0, 14716.0, 9285.0, 20826.0, 3711.0, 13802.0, 7132.0, 4292.0, 29817.0, 14812.0, 22433.0, 13472.0, 8852.0, 22479.0, 2174.0, 7694.0, 25308.0, 2952.0, 6878.0, 29918.0, 14503.0, 26759.0, 9819.0, 23612.0, 27716.0, 9314.0, 15702.0, 1635.0, 2496.0, 10274.0, 2074.0, 27656.0, 3865.0, 23796.0, 6612.0, 21006.0, 20618.0, 16617.0, 2216.0, 28163.0, 12760.0, 4298.0, 30001.0, 31494.0, 27569.0, 16073.0, 4406.0, 10945.0, 32331.0, 2718.0, 13286.0, 22297.0, 19029.0, 17620.0, 23337.0, 26896.0, 19630.0, 23705.0, 23364.0, 22291.0, 21590.0, 299.0, 18180.0, 4340.0, 15573.0, 26691.0, 11739.0, 13109.0, 7029.0, 12174.0, 6233.0, 11161.0, 28139.0, 28516.0, 10230.0, 10096.0, 10825.0, 12349.0, 3004.0, 28204.0, 4913.0, 8731.0, 10034.0, 23913.0, 15088.0, 31084.0, 15438.0, 22244.0, 14616.0, 32016.0, 19310.0, 9399.0, 27345.0, 27258.0, 2518.0, 22356.0, 31423.0, 7363.0, 20906.0, 30786.0, 26843.0, 13215.0, 12412.0, 10976.0, 30257.0, 3712.0, 30217.0, 22557.0, 30031.0, 6146.0, 26784.0, 27008.0, 4628.0, 7838.0, 18173.0, 21956.0, 31218.0, 30451.0, 11064.0, 7588.0, 16135.0, 7671.0, 8407.0, 14443.0, 11955.0, 4273.0, 7208.0, 21231.0, 8912.0, 16179.0, 29972.0, 5334.0, 7153.0, 12923.0, 30722.0, 9122.0, 9803.0, 15112.0, 23019.0, 6974.0, 24929.0, 22445.0, 28955.0, 23064.0, 7392.0, 30145.0, 29033.0, 25451.0, 11442.0, 7393.0, 13990.0, 5473.0, 13129.0, 20383.0, 31221.0, 1342.0, 26586.0, 20145.0, 26273.0, 7470.0, 2377.0, 21062.0, 6941.0, 14820.0, 18993.0, 3620.0, 1381.0, 30006.0, 28998.0, 24689.0, 22507.0, 18088.0, 19.0, 13826.0, 4488.0, 6125.0, 7260.0, 5859.0, 22685.0, 21825.0, 19365.0, 30637.0, 13390.0, 17643.0, 17127.0, 8540.0, 17258.0, 6316.0, 30223.0, 29244.0, 30595.0, 3254.0, 18967.0, 26870.0, 18637.0, 21973.0, 21614.0, 22152.0, 16944.0, 5651.0, 24093.0, 2583.0, 5878.0, 17433.0, 2501.0, 13262.0, 21231.0, 4881.0, 27894.0, 18173.0, 21016.0, 21302.0, 18840.0, 14524.0, 6681.0, 14384.0, 772.0, 14199.0, 16610.0, 26755.0, 8060.0, 17046.0, 11355.0, 14038.0, 29889.0, 31962.0, 2738.0, 29070.0, 27700.0, 9932.0, 20832.0, 16493.0, 27151.0, 11687.0, 2909.0, 23509.0, 19655.0, 15357.0, 7766.0, 18807.0, 17959.0, 24270.0, 30751.0, 4390.0, 3081.0, 30326.0, 5149.0, 22305.0, 1491.0, 6161.0, 18076.0, 25563.0, 28592.0, 15428.0, 15584.0, 16174.0, 7469.0, 5271.0, 6568.0, 480.0, 22097.0, 4012.0, 6938.0, 31324.0, 47.0, 22430.0, 5966.0, 22294.0, 9734.0, 11152.0, 7226.0, 18070.0, 17.0, 1417.0, 14424.0, 24687.0, 13576.0, 29565.0, 27591.0, 9386.0, 25639.0, 2625.0, 29756.0, 26622.0, 4410.0, 13279.0, 9951.0, 12816.0, 30679.0, 7109.0, 26909.0, 19604.0, 21308.0, 16081.0, 22536.0, 17864.0, 31677.0, 30035.0, 24367.0, 20883.0, 12153.0, 20713.0, 14558.0, 13583.0, 8836.0, 22458.0, 9804.0, 31594.0, 3604.0, 30949.0, 12129.0, 16523.0, 16866.0, 2397.0, 4767.0, 19096.0, 28170.0, 30186.0, 5300.0, 1460.0, 7805.0, 30554.0, 3713.0, 23211.0, 22427.0, 20682.0, 16206.0, 25179.0, 30701.0, 13137.0, 16525.0, 13243.0, 26759.0, 21887.0, 10999.0, 23761.0, 24802.0, 19471.0, 9967.0, 18269.0, 1353.0, 19346.0, 9875.0, 18748.0, 20095.0, 6408.0, 2509.0, 12446.0, 8814.0, 5222.0, 24807.0, 14015.0, 20958.0, 5741.0, 3638.0, 7842.0, 30870.0, 24449.0, 27261.0, 23075.0, 3168.0, 20397.0, 10832.0, 11343.0, 11393.0, 27473.0, 29055.0, 3659.0, 6077.0, 6284.0, 23143.0, 20342.0, 2786.0, 18839.0, 3819.0, 13828.0, 6750.0, 19369.0, 4278.0, 16174.0, 1084.0, 12979.0, 21310.0, 15105.0, 29530.0, 29967.0, 32406.0, 30800.0, 7803.0, 18684.0, 16854.0, 9515.0, 19130.0, 20744.0, 7853.0, 4439.0, 2144.0, 12754.0, 30282.0, 21267.0, 22397.0, 289.0, 22266.0, 4570.0, 20039.0, 21668.0, 11474.0}" > /dev/null
